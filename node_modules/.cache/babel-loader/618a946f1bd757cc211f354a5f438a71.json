{"ast":null,"code":"import _defineProperty from\"/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{Component}from\"react\";import\"../../../node_modules/bootstrap/dist/css/bootstrap.min.css\";import Nav from\"./Nav\";import Footer from\"./Footer\";import{Redirect}from\"../../../node_modules/react-router-dom\";import className from\"../../../node_modules/classnames\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(prop){var _this;_classCallCheck(this,Login);_this=_super.call(this,prop);_this.onChangeHandler=function(event){var inputName=event.target.name;var inputValue=event.target.value;_this.setState(_defineProperty({},inputName,inputValue));if(inputName===\"email\"){if(!_this.emailValidation(inputValue)){_this.setState({emailMgs:\"* Invalid Email\",emailError:false});}else{_this.setState({emailMgs:\"\",emailError:true});}}};_this.state={email:null,password:null,login:false,store:null,passwordError:true,emailError:true,emailMgs:\"\",passMgs:\"\"};return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var user=localStorage.getItem(\"login\");// your saved token in localstorage\nif(user&&user!==\"undefined\"){// check for not undefined\nthis.props.history.push(\"/\");// now you can redirect your desired route\n}}},{key:\"loginButtonPressed\",value:function loginButtonPressed(){if(this.state.emailError){this.login();}}},{key:\"emailValidation\",value:function emailValidation(email){var re=/^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$/;return re.test(String(email).toLowerCase());}},{key:\"login\",value:function login(){var _this2=this;var formdata=new FormData();formdata.append(\"email\",this.state.email);formdata.append(\"password\",this.state.password);var requestOptions={method:\"POST\",body:formdata,redirect:\"follow\"};fetch(\"https://exampleblogforgrayit.herokuapp.com/api/token/\",requestOptions).then(function(response){return response.json();}).then(function(result){if(result.access){//console.warn(\"results\", result);\nlocalStorage.setItem(\"login\",JSON.stringify({login:true,store:result.access,email:_this2.state.email}));console.log(\"ok\");_this2.setState({login:true});}else{alert(\"Username or password incorrect\");}}).catch(function(error){return console.log(\"error\",error);});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Nav,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container all-margin-top minimum-height\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mt-5\"}),/*#__PURE__*/_jsxs(\"h1\",{className:\"mt-5 mb-3 text-left\",children:[\"Login\",/*#__PURE__*/_jsx(\"small\",{children:\" Form\"})]}),/*#__PURE__*/_jsx(\"ol\",{className:\"breadcrumb\",children:/*#__PURE__*/_jsx(\"li\",{className:\"breadcrumb-item active\",children:\"Login\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-4 mb-4\",children:/*#__PURE__*/_jsxs(\"form\",{name:\"sentMessage\",id:\"contactForm\",className:\"text-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"control-group form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:className(\"form-control\",!this.state.emailError&&\"is-invalid\"),id:\"email\",name:\"email\",onChange:this.onChangeHandler}),/*#__PURE__*/_jsx(\"small\",{className:\"invalid_input\",children:this.state.emailMgs})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"control-group form-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password*\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",name:\"password\",onChange:this.onChangeHandler})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"success\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){_this3.loginButtonPressed();},className:\"btn btn-primary\",id:\"login-btn\",children:\"Login\"}),this.state.login?/*#__PURE__*/_jsx(Redirect,{to:\"/posts\"}):/*#__PURE__*/_jsx(\"div\",{})]})})})]}),/*#__PURE__*/_jsx(Footer,{})]});}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["/mnt/C8EE989BEE98837C/Django Projects/react-first/my-app/src/mycomponents/Login.js"],"names":["React","Component","Nav","Footer","Redirect","className","Login","prop","onChangeHandler","event","inputName","target","name","inputValue","value","setState","emailValidation","emailMgs","emailError","state","email","password","login","store","passwordError","passMgs","user","localStorage","getItem","props","history","push","re","test","String","toLowerCase","formdata","FormData","append","requestOptions","method","body","redirect","fetch","then","response","json","result","access","setItem","JSON","stringify","console","log","alert","catch","error","loginButtonPressed"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"../../../node_modules/bootstrap/dist/css/bootstrap.min.css\";\nimport Nav from \"./Nav\";\nimport Footer from \"./Footer\";\nimport { Redirect } from \"../../../node_modules/react-router-dom\";\nimport className from \"../../../node_modules/classnames\";\nclass Login extends Component {\n  constructor(prop) {\n    super(prop);\n    this.state = {\n      email: null,\n      password: null,\n      login: false,\n      store: null,\n      passwordError: true,\n      emailError: true,\n      emailMgs: \"\",\n      passMgs: \"\",\n    };\n  }\n  componentDidMount() {\n    const user = localStorage.getItem(\"login\"); // your saved token in localstorage\n    if (user && user !== \"undefined\") {\n      // check for not undefined\n      this.props.history.push(\"/\"); // now you can redirect your desired route\n    }\n  }\n  onChangeHandler = (event) => {\n    var inputName = event.target.name;\n    var inputValue = event.target.value;\n    this.setState({\n      [inputName]: inputValue,\n    });\n    if (inputName === \"email\") {\n      if (!this.emailValidation(inputValue)) {\n        this.setState({\n          emailMgs: \"* Invalid Email\",\n          emailError: false,\n        });\n      } else {\n        this.setState({\n          emailMgs: \"\",\n          emailError: true,\n        });\n      }\n    }\n  };\n  loginButtonPressed() {\n    if (this.state.emailError) {\n      this.login();\n    }\n  }\n  emailValidation(email) {\n    const re = /^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$/;\n    return re.test(String(email).toLowerCase());\n  }\n  login() {\n    var formdata = new FormData();\n    formdata.append(\"email\", this.state.email);\n    formdata.append(\"password\", this.state.password);\n\n    var requestOptions = {\n      method: \"POST\",\n      body: formdata,\n      redirect: \"follow\",\n    };\n\n    fetch(\"https://exampleblogforgrayit.herokuapp.com/api/token/\", requestOptions)\n      .then((response) => response.json())\n      .then((result) => {\n        if (result.access) {\n          //console.warn(\"results\", result);\n          localStorage.setItem(\n            \"login\",\n            JSON.stringify({\n              login: true,\n              store: result.access,\n              email: this.state.email,\n            })\n          );\n          console.log(\"ok\");\n          this.setState({ login: true });\n        } else {\n          alert(\"Username or password incorrect\");\n        }\n      })\n      .catch((error) => console.log(\"error\", error));\n  }\n\n  render() {\n    return (\n      <div>\n        <Nav />\n        <div className=\"container all-margin-top minimum-height\">\n          <div className=\"mt-5\"></div>\n          <h1 className=\"mt-5 mb-3 text-left\">\n            Login\n            <small> Form</small>\n          </h1>\n          <ol className=\"breadcrumb\">\n            <li className=\"breadcrumb-item active\">Login</li>\n          </ol>\n\n          <div className=\"row\">\n            <div className=\"col-lg-4 mb-4\">\n              <form name=\"sentMessage\" id=\"contactForm\" className=\"text-left\">\n                <div className=\"control-group form-group\">\n                  <div className=\"controls\">\n                    <label>Email*</label>\n                    <input\n                      type=\"email\"\n                      className={className(\n                        \"form-control\",\n                        !this.state.emailError && \"is-invalid\"\n                      )}\n                      id=\"email\"\n                      name=\"email\"\n                      onChange={this.onChangeHandler}\n                    ></input>\n                    <small className=\"invalid_input\">\n                      {this.state.emailMgs}\n                    </small>\n                  </div>\n                </div>\n                <div className=\"control-group form-group\">\n                  <div className=\"controls\">\n                    <label>Password*</label>\n                    <input\n                      type=\"password\"\n                      className=\"form-control\"\n                      id=\"password\"\n                      name=\"password\"\n                      onChange={this.onChangeHandler}\n                    ></input>\n                  </div>\n                </div>\n                <div id=\"success\"></div>\n\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    this.loginButtonPressed();\n                  }}\n                  className=\"btn btn-primary\"\n                  id=\"login-btn\"\n                >\n                  Login\n                </button>\n                {this.state.login ? <Redirect to=\"/posts\" /> : <div></div>}\n              </form>\n            </div>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n}\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}